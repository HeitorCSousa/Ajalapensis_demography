# Balancing fire regimes and population dynamics for the conservation of a microendemic lizard from a biodiversity hotspot

**Current Status:** *Manuscript submitted to Animal Conservation*

## ğŸ“ About the Project

This repository contains the data and code used to investigate how variation in fire regimes shapes the demographic performance of *Ameivula jalapensis*, a microendemic lizard from the Brazilian Cerrado.

**Study System:** \* **Species:** *Ameivula jalapensis* (Squamata: Teiidae) \* **Location:** Serra Geral do Tocantins Ecological Station (EESGT), JalapÃ£o, Brazil. \* **Context:** Integrated Fire Management (IFM) in a global biodiversity hotspot.

**Key Findings:** Using mark-recapture and Bayesian hierarchical models, we found that severe fire regimes act as environmental filters. They benefit resilient adults (improved body condition and activity due to open habitats) but constrain recruitment, likely due to thermal constraints on juveniles.

## ğŸ‘¥ Authors and Affiliations

-   **Geisa Kely Leandro Vitorino da Silva**Â¹
-   **Heitor Campos de Sousa**Â¹,Â² (Corresponding Author: heitorsousa.bio\@gmail.com)
-   **Bruna de FranÃ§a Gomes**Â³
-   **Marcio Martins**â´
-   **Adriana Malvasio**Â¹
-   **Guarino Rinaldi Colli**Â²
-   **Thiago Costa GonÃ§alves Portelinha**Â¹

Â¹ *Universidade Federal do Tocantins (UFT), Palmas, TO, Brazil* Â² *Universidade de BrasÃ­lia (UnB), BrasÃ­lia, DF, Brazil* Â³ *Universidade de SÃ£o Paulo (USP), SÃ£o Paulo, SP, Brazil*

## ğŸ“‚ Repository Structure

To replicate the analysis, ensure your directory is organized as follows:

\`\`\`text . â”œâ”€â”€ Data/ â”‚ â”œâ”€â”€ Ameivula_jalapensis_04.txt \# Main capture data â”‚ â”œâ”€â”€ Ameivula_jalapensis_EESGT_BrunaGomes.xlsx \# Rotating plots data â”‚ â”œâ”€â”€ CT_Data.txt \# Critical thermal limits data â”‚ â”œâ”€â”€ loc_perf_SGT.txt \# Locomotor performance data â”‚ â”œâ”€â”€ Data_Tpref_SGT.txt \# Preferred temperature data â”‚ â”œâ”€â”€ microclimate_EESGT.rds \# Datalogger microclimate records â”‚ â”œâ”€â”€ env_vars.rds \# Vegetation structure variables â”‚ â”œâ”€â”€ Points_Traps.txt \# Trap coordinates (Fixed) â”‚ â””â”€â”€ Points_Traps_Bruna_Heitor.txt \# Trap coordinates (All) â”‚ â”œâ”€â”€ Output/ â”‚ â”œâ”€â”€ SGT_Fire.tif \# Generated Fire Raster (Script 1) â”‚ â”œâ”€â”€ tpc_Ajalapensis.rds \# Thermal Performance Curve model (Script 2) â”‚ â””â”€â”€ ... (Other intermediate files generated by scripts) â”‚ â”œâ”€â”€ scripts/ â”‚ â”œâ”€â”€ 01_MODIS_FireRegimes_SGT.R \# Downloads and processes MODIS fire data â”‚ â”œâ”€â”€ 02_Env_Data.R \# Processes microclimate & ecophysiology â”‚ â””â”€â”€ 03_Ameivula_jalapensis_Analysis.R \# Main demographic analysis (openCR, brms, INLA) â”‚ â””â”€â”€ README.md

## ğŸš€ How to Run the Analysis

The scripts must be executed in a specific order, as downstream scripts rely on data generated by upstream ones.

**1. Fire Regime Characterization**

-   **Script:**Â `01_MODIS_FireRegimes_SGT.R`

-   **Action:**Â Downloads MODIS burned area data (`MCD64A1`), calculates Time Since Last Fire (TSLF), Fire Frequency, and Severity indices.

-   **Output:**Â GeneratesÂ `fire_traps_df.csv`Â andÂ `fire_regimes_traps_df.csv`Â in theÂ `Data/`Â folder.

**2. Environmental & Ecophysiological Processing**

-   **Script:**Â `02_Env_Data.R`

-   **Action:**Â Merges fire data with vegetation structure. Calculates Thermal Performance Curves (TPC) and imputes missing environmental data usingÂ `missForest`.

-   **Output:**Â GeneratesÂ `env_data_SGT.rds`Â used in the final analysis.

**3. Demographic Modeling**

-   **Script:**Â `03_Ameivula_jalapensis_Analysis.R`Â (Renamed fromÂ `Ameivula_jalapensis_2024_10_10.R`)

-   **Action:**

    -   Runs Pradel-Jolly-Seber models (`openCR`).

    -   Runs Bayesian Hierarchical Models (`brms`) for SVL, Body Condition, and Sex Ratio.

    -   Runs N-mixture models (`R-INLA`) for abundance.

    -   Generates the final figures and maps.

## ğŸ’» Software and Dependencies

The analyses were performed usingÂ **R version 4.5.1**.

### Key R Packages

You will need to install the following packages:

**General Data Manipulation & Plotting:**Â `tidyverse`,Â `dplyr`,Â `lubridate`,Â `ggplot2`,Â `viridis`,Â `scales`,Â `readxl`,Â `GGally`

**Spatial Analysis:**Â `sf`,Â `sp`,Â `terra`,Â `raster`,Â `tidyterra`,Â `geobr`,Â `maptiles`,Â `spData`,Â `MODISTools`

**Statistical Modeling:**

-   `openCR`Â (Capture-Recapture)

-   `brms`Â (Bayesian Multilevel Models)

-   `gamm4`Â (Generalized Additive Mixed Models)

-   `projpred`Â (Projection Predictive Variable Selection)

-   `missForest`Â (Data Imputation)

-   `Boruta`Â (Feature Selection)

-   `lmodel2`Â (Model II Regression)

-   `emmeans`Â (Marginal Means)

**INLA (Integrated Nested Laplace Approximation):**Â `R-INLA`Â is not on CRAN. Install it using:

```{r}
install.packages("INLA", 
                 repos=c(getOption("repos"), 
                         INLA="[https://inla.r-inla-download.org/R/stable](https://inla.r-inla-download.org/R/stable)"), 
                 dep=TRUE)
```

## ğŸ“Š Data Availability

The data supporting the results of this article will be archived inÂ **\[Zenodo/Dryad\]**Â and the DOI will be listed here upon publication.

### **1. Population Monitoring Data**

-   `Ameivula_jalapensis_EESGT_BrunaGomes.xlsx`

    -   **Description:**Â The main dataset containing capture records forÂ *Ameivula jalapensis*Â from the rotating plots.

    -   **Key Variables:**

        -   `fieldtrip`: Campaign identifier (e.g., C1, C6).

        -   `date`,Â `hour`: Date and time of capture.

        -   `trap_code`: Unique identifier for the trap (e.g., C1-7A).

        -   `treatment`: Fire treatment code (e.g., C = Control/Unburned, Q = Burned).

        -   `specie`: Species name (*jalapensis*).

        -   `sex`,Â `svl_mm`,Â `weight_animal`: Biological measurements (Sex, Snout-Vent Length, Weight).

        -   `recapture`: Indicates if the individual is a recapture.

        -   `lat`,Â `long`: Geographic coordinates.

### **2. Spatial & Trap Location Data**

-   **`Points_Traps_Bruna_Heitor.txt`**

    -   **Description:**Â A master file containing coordinates and metadata for all sampling points (likely combining Fixed and Rotating plots).

    -   **Key Variables:**

        -   `fieldtrip`: Campaign ID.

        -   `point`,Â `trap`,Â `trap_code`: Identifiers for the specific trap location.

        -   `tslf`: Time Since Last Fire (categorical or continuous).

        -   `treatment`: Treatment type (e.g., C, Q).

        -   `Latitude`,Â `Longitude`: WGS84 coordinates.

        -   `elevation`: Elevation in meters.

-   **`Points_Traps.txt`**

    -   **Description:**Â Coordinates for specific plots (likely the Fixed plots or a specific subset).

    -   **Key Variables:**Â `plot`,Â `trap`,Â `lat`,Â `long`,Â `locality`Â (e.g., PEL).

-   **`pontos_aiq.csv`**Â (from Excel)

    -   **Description:**Â Additional spatial data for specific "AIQ" points.

    -   **Key Variables:**Â `campanha`Â (Campaign),Â `ponto`,Â `armadilha`Â (Trap),Â `lat`,Â `long`,Â `elevacao`.

-   **`coord_acampamentos.csv`**

    -   **Description:**Â Locations of the base camps used during fieldwork.

    -   **Key Variables:**Â `acampamento`Â (Camp name),Â `lat`,Â `long`.

### **3. Fire Regime Data (Derived from MODIS)**

-   **`fire_regimes_traps_df.csv`**

    -   **Description:**Â Summarized fire metrics calculated for each trap location, used for statistical modeling.

    -   **Key Variables:**

        -   `freq`: Fire frequency (number of times burned).

        -   `MeanTSLF`: Mean Time Since Last Fire.

        -   `severity`: Calculated fire regime severity index.

        -   `MFRI`: Mean Fire Return Interval.

        -   `treatment`,Â `TSLF`: Treatment and current time since fire.

-   **`fire_traps_df.csv`**

    -   **Description:**Â Time-series data of burn events for each trap location.

    -   **Key Variables:**Â `burn_date`,Â `year`,Â `month`,Â `fire`Â (binary: 0/1),Â `TSLF`Â (time steps since last fire).

-   **`fire_regimes_months_df.csv`**

    -   **Description:**Â Monthly fire data likely used to calculate the severity index.

    -   **Key Variables:**Â `month`,Â `fire`,Â `weight`Â (seasonality weight for severity),Â `severity`.

### **4. Ecophysiological Data**

-   **`CT_Data.txt`**

    -   **Description:**Â Critical thermal limits (CTmaxâ€‹Â andÂ CTminâ€‹) for captured individuals.

    -   **Key Variables:**

        -   `Species`: Species name.

        -   `Ctmin`,Â `Ctmax`: Critical thermal minimum and maximum temperatures.

        -   `Sex`,Â `SVL`: Individual traits.

        -   `Broken_Tail`: Flag for individuals with tail loss (potential stressor).

-   **`loc_perf_SGT.txt`**

    -   **Description:**Â Locomotor performance data (running speed) measured at different temperatures.

    -   **Key Variables:**

        -   `Temp`: Body temperature during the trial.

        -   `Run`: Trial number.

        -   `v`: Velocity/Speed (likely max speed in m/s).

        -   `a`: Acceleration.

        -   `x`,Â `y`: Position coordinates on the track.

-   **`Data_Tpref_SGT.txt`**

    -   **Description:**Â Preferred body temperature (Tprefâ€‹) data from thermal gradient experiments.

    -   **Key Variables:**

        -   `temp`: Selected body temperature.

        -   `sp`: Species.

        -   `SGT`: Individual ID.

## ğŸ›¡ï¸ License

This project is licensed under the MIT License - see theÂ `LICENSE`Â file for details.

## ğŸ’° Funding and Acknowledgments

This work was supported by:

-   Fundo Brasileiro para a Biodiversidade (Funbio)

-   Instituto Humanize

-   Conselho Nacional de Desenvolvimento CientÃ­fico e TecnolÃ³gico (CNPq)

-   CoordenaÃ§Ã£o de AperfeiÃ§oamento de Pessoal de NÃ­vel Superior (CAPES)

-   FundaÃ§Ã£o de Amparo Ã  Pesquisa do Estado de SÃ£o Paulo (FAPESP)

Logistical support provided byÂ **UFT**Â andÂ **ICMBio**Â (EESGT fire brigade).